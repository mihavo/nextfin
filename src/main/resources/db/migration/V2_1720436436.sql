CREATE TABLE ADDRESS
(
    ID            BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    STREET        VARCHAR(255)                            NOT NULL,
    NUMBER        INTEGER                                 NOT NULL,
    FLOOR         INTEGER,
    CITY          VARCHAR(255)                            NOT NULL,
    STATE         VARCHAR(255)                            NOT NULL,
    ZIP_CODE      VARCHAR(255)                            NOT NULL,
    TYPE          SMALLINT                                NOT NULL,
    CREATION_DATE DATE                                    NOT NULL,
    UPDATED_DATE  DATE                                    NOT NULL,
    CONSTRAINT PK_ADDRESS PRIMARY KEY (ID)
);

ALTER TABLE CARDS
    ADD CONSTRAINT FK_CARDS_ON_BILLING_ADDRESS FOREIGN KEY (BILLING_ADDRESS_ID) REFERENCES ADDRESS (ID);

ALTER TABLE HOLDERS
    ADD CONSTRAINT FK_HOLDERS_ON_ADDRESS FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESS (ID);

ALTER TABLE CARDS
    DROP COLUMN BILLING_ADDRESS;

ALTER TABLE CARDS
    DROP COLUMN CVV;

ALTER TABLE TRANSACTIONS
    ALTER COLUMN AMOUNT TYPE DECIMAL USING (AMOUNT::DECIMAL);

ALTER TABLE ACCOUNTS
    ALTER COLUMN BALANCE TYPE DECIMAL USING (BALANCE::DECIMAL);

ALTER TABLE CARDS
    ALTER COLUMN CARDHOLDER_NAME TYPE VARCHAR(26) USING (CARDHOLDER_NAME::VARCHAR(26));

ALTER TABLE CARDS
    ADD CVV BIGINT NOT NULL;

ALTER TABLE TRANSACTIONS
    ALTER COLUMN FEE TYPE DECIMAL USING (FEE::DECIMAL);